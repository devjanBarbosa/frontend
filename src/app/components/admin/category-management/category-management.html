<div class="container-fluid category-manager">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="title-section">
        <h1 class="page-title">
          <i class="fas fa-layer-group"></i>
          Gestão de Categorias
        </h1>
        <p class="page-subtitle">
          Organize os produtos da sua loja em categorias para facilitar a navegação dos clientes
        </p>
      </div>
      <div class="header-stats">
        <div class="stat-card">
          <i class="fas fa-boxes stat-icon"></i>
          <div class="stat-content">
            <span class="stat-number">{{ getCategoriasProduto().length }}</span>
            <span class="stat-label">Produtos</span>
          </div>
        </div>
        <div class="stat-card">
          <i class="fas fa-gifts stat-icon"></i>
          <div class="stat-content">
            <span class="stat-number">{{ getCategoriasPresente().length }}</span>
            <span class="stat-label">Presentes</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-4">
    <!-- Form Section -->
    <div class="col-xl-4 col-lg-5">
      <div class="card form-card">
        <div class="card-header">
          <div class="header-icon">
            <i class="fas fa-plus-circle"></i>
          </div>
          <div class="header-text">
            <h5 class="header-title">Nova Categoria</h5>
            <p class="header-description">Adicione uma nova categoria ao seu catálogo</p>
          </div>
        </div>
        
        <div class="card-body">
          <form [formGroup]="categoryForm" (ngSubmit)="onSubmit()" class="category-form">
            
            <!-- Campo Nome -->
            <div class="form-group">
              <label for="nome" class="form-label">
                <i class="fas fa-tag"></i>
                Nome da Categoria
              </label>
              <div class="input-wrapper">
                <input 
                  type="text" 
                  id="nome" 
                  class="form-control"
                  [class.is-invalid]="categoryForm.get('nome')?.invalid && categoryForm.get('nome')?.touched"
                  formControlName="nome" 
                  placeholder="Ex: Cuidados Faciais, Presentes Especiais..."
                  maxlength="50">
                <div class="input-icon">
                  <i class="fas fa-edit"></i>
                </div>
              </div>
              <div class="form-feedback">
                <div *ngIf="categoryForm.get('nome')?.invalid && categoryForm.get('nome')?.touched" 
                     class="invalid-feedback">
                  <i class="fas fa-exclamation-triangle"></i>
                  O nome deve ter entre 3 e 50 caracteres
                </div>
                <div *ngIf="categoryForm.get('nome')?.valid && categoryForm.get('nome')?.value?.length >= 3" 
                     class="valid-feedback">
                  <i class="fas fa-check-circle"></i>
                  Nome válido
                </div>
              </div>
            </div>

            <!-- Tipo de Categoria -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-layer-group"></i>
                Tipo de Categoria
              </label>
              <div class="radio-group">
                <label class="radio-option" 
                       [class.selected]="categoryForm.get('tipo')?.value === 'PRODUTO'">
                  <input type="radio" value="PRODUTO" formControlName="tipo">
                  <div class="radio-content">
                    <div class="radio-icon produto">
                      <i class="fas fa-box"></i>
                    </div>
                    <div class="radio-text">
                      <span class="radio-title">Produto</span>
                      <span class="radio-description">Para itens do catálogo</span>
                    </div>
                  </div>
                  <div class="radio-check">
                    <i class="fas fa-check"></i>
                  </div>
                </label>
                
                <label class="radio-option" 
                       [class.selected]="categoryForm.get('tipo')?.value === 'PRESENTE'">
                  <input type="radio" value="PRESENTE" formControlName="tipo">
                  <div class="radio-content">
                    <div class="radio-icon presente">
                      <i class="fas fa-gift"></i>
                    </div>
                    <div class="radio-text">
                      <span class="radio-title">Presente</span>
                      <span class="radio-description">Para ocasiões especiais</span>
                    </div>
                  </div>
                  <div class="radio-check">
                    <i class="fas fa-check"></i>
                  </div>
                </label>
              </div>
            </div>

            <!-- Botão Submit -->
            <button 
              type="submit" 
              class="btn btn-primary btn-submit"
              [disabled]="categoryForm.invalid || isSubmitting"
              [class.loading]="isSubmitting">
              <span *ngIf="!isSubmitting" class="btn-content">
                <i class="fas fa-plus-circle"></i>
                Adicionar Categoria
              </span>
              <span *ngIf="isSubmitting" class="btn-loading">
                <i class="fas fa-spinner fa-spin"></i>
                Adicionando...
              </span>
            </button>
          </form>
        </div>
      </div>

      <!-- Quick Tips Card -->
      <div class="card tips-card">
        <div class="card-body">
          <h6 class="tips-title">
            <i class="fas fa-lightbulb"></i>
            Dicas para Organização
          </h6>
          <ul class="tips-list">
            <li><strong>Produtos:</strong> Organize por tipo ou função (ex: Hidratantes, Limpeza)</li>
            <li><strong>Presentes:</strong> Separe por ocasião (ex: Aniversário, Natal)</li>
            <li>Use nomes claros e específicos para facilitar a busca</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Categories List Section -->
    <div class="col-xl-8 col-lg-7">
      <div class="card categories-card">
        <div class="card-header">
          <div class="header-content-list">
            <div class="header-text">
              <h5 class="header-title">Categorias Existentes</h5>
              <p class="header-description">{{ categorias.length }} categorias cadastradas</p>
            </div>
            <div class="header-actions">
              <button class="btn btn-outline-secondary btn-refresh" 
                      (click)="carregarCategorias()"
                      [disabled]="isLoading">
                <i class="fas fa-sync-alt" [class.fa-spin]="isLoading"></i>
                Atualizar
              </button>
            </div>
          </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="isLoading" class="loading-state">
          <div class="loading-content">
            <div class="spinner-wrapper">
              <div class="spinner"></div>
            </div>
            <h6 class="loading-title">Carregando categorias...</h6>
            <p class="loading-description">Por favor aguarde</p>
          </div>
        </div>

        <!-- Categories List -->
        <div *ngIf="!isLoading && categorias.length > 0" class="categories-list">
          <!-- Filter Tabs -->
          <div class="filter-tabs">
            <button class="filter-tab" 
                    [class.active]="activeFilter === 'TODOS'"
                    (click)="setActiveFilter('TODOS')">
              <i class="fas fa-th-list"></i>
              Todas ({{ categorias.length }})
            </button>
            <button class="filter-tab" 
                    [class.active]="activeFilter === 'PRODUTO'"
                    (click)="setActiveFilter('PRODUTO')">
              <i class="fas fa-box"></i>
              Produtos ({{ getCategoriasProduto().length }})
            </button>
            <button class="filter-tab" 
                    [class.active]="activeFilter === 'PRESENTE'"
                    (click)="setActiveFilter('PRESENTE')">
              <i class="fas fa-gift"></i>
              Presentes ({{ getCategoriasPresente().length }})
            </button>
          </div>

          <!-- Categories Grid -->
          <div class="categories-grid">
            <div *ngFor="let categoria of getFilteredCategorias(); trackBy: trackByCategoria" 
                 class="category-item"
                 [@fadeInUp]>
              
              <div class="category-content">
                <div class="category-badge" 
                     [ngClass]="'badge-' + categoria.tipo.toLowerCase()">
                  <i [class]="categoria.tipo === 'PRODUTO' ? 'fas fa-box' : 'fas fa-gift'"></i>
                </div>
                
                <div class="category-info">
                  <h6 class="category-name">{{ categoria.nome }}</h6>
                  <span class="category-type">{{ categoria.tipo | titlecase }}</span>
                </div>
              </div>

              <div class="category-actions">
                <button class="btn btn-action btn-edit" 
                        (click)="onEdit(categoria)"
                        title="Editar categoria">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-action btn-delete" 
                        (click)="onDelete(categoria)"
                        title="Remover categoria">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!isLoading && categorias.length === 0" class="empty-state">
          <div class="empty-content">
            <div class="empty-icon">
              <i class="fas fa-folder-open"></i>
            </div>
            <h6 class="empty-title">Nenhuma categoria encontrada</h6>
            <p class="empty-description">
              Comece organizando seus produtos criando a primeira categoria.
            </p>
            <button class="btn btn-primary btn-create-first" 
                    (click)="focusNameInput()">
              <i class="fas fa-plus"></i>
              Criar Primeira Categoria
            </button>
          </div>
        </div>

        <!-- Filtered Empty State -->
        <div *ngIf="!isLoading && categorias.length > 0 && getFilteredCategorias().length === 0" 
             class="empty-state filtered">
          <div class="empty-content">
            <div class="empty-icon">
              <i class="fas fa-filter"></i>
            </div>
            <h6 class="empty-title">Nenhuma categoria encontrada</h6>
            <p class="empty-description">
              Não há categorias do tipo <strong>{{ activeFilter.toLowerCase() }}</strong>.
            </p>
            <button class="btn btn-outline-primary" 
                    (click)="setActiveFilter('TODOS')">
              <i class="fas fa-eye"></i>
              Ver Todas
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>